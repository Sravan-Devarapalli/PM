-- =======================================================================================================================================
-- Updated by:	Sainath
-- Update date: 05-21-2012
-- Description:	Checks weather given person has timeentries after termination date(Timeentries on termination date is not included).
-- =======================================================================================================================================
CREATE PROCEDURE [dbo].[CheckPersonTimeEntriesAfterTerminationDate]
(
	@PersonId	INT,
	@TerminationDate	DATETIME
)
AS
BEGIN
	DECLARE @TimeEntriesExists BIT

	DECLARE @TerminationDateLocal	DATE
	SET @TerminationDateLocal = @TerminationDate	

	IF EXISTS(
				SELECT 1 FROM dbo.TimeEntry TE
				WHERE TE.PersonId = @PersonId AND TE.ChargeCodeDate > @TerminationDateLocal AND TE.IsAutoGenerated <> 1
			)
		SET @TimeEntriesExists  = 1
	ELSE
		SET @TimeEntriesExists = 0

	SELECT @TimeEntriesExists

END

